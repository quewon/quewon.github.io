<!DOCTYPE html>
	<meta charset="utf-8" content="">
	<head>
		<title>q1's room</title>
		<link rel="stylesheet" href="master.css">
		<style>
		#container {
			position: absolute;
			height: fit-content;
			width: 100%;
		}

		#main {
			float: left;
			padding: 3em;
			width: 40%;
			box-sizing: border-box;
		}

		#frame {
			/*margin-left: 1em;*/
			float: right;
			padding: 0;
			height: 100vh;
			width: 60%;
		}

		.inf {
			overflow: hidden;
			max-height: 0;
		}

		#tag {
			position: absolute;
			top: 2em;
			right: 0;
			padding: 1em;
			background-color: var(--bg);
			opacity: 0.9;
			font-style: italic;
		}

		@media only screen and (max-width: 800px) {
			#main {
				width: 100%;
				height: fit-content;
			}
			#frame {
				width: 100%;
			}
			#container {
				padding-bottom: 5em;
			}
			#tag {
				position: absolute;
				top: auto;
				bottom: 0;
				padding: 2em;
				width: 100%;
				text-align: center;
				box-sizing: border-box;
				height: 5em;
			}
		}

		@media only screen and (max-device-width: 480px) {
			#main {
				width: 100%;
			}
			#frame {
				width: 100%;
				height: 60vh;
			}
			#container {
				padding-bottom: 5em;
			}
			#tag {
				position: absolute;
				top: auto;
				bottom: 0;
				padding: 2em;
				width: 100vw;
				text-align: center;
				box-sizing: border-box;
				height: 5em;
			}
		}

		.date {
			font-family: monospace;
			font-size: 8pt;
			flex-shrink: 0;   /* do not shrink - initial value: 1 */
			flex-basis: 5rem;
			width: 5rem;
			display: inline-block;
		}

		ul {
			padding-left: 0;
		}

		.category.open > a + ul.inf {
			max-height: fit-content;
			margin-bottom: 1rem;
		}

		.category::before {
			display: inline-block;
			content: "+ ";
			width: 1rem;
			flex-shrink: 0;
		}
		.category.open::before {
			content: "â€“ ";
		}
		.category > a {
			padding-right: 2rem;
		}

		li {
			display: flex;
			margin-left: 0;
		}

		#tooltip {
			position: absolute;
			display: block;
			padding: .2rem;
			background: var(--text);
			color: var(--bg);
			pointer-events: none;
			margin: 10px;
			opacity: 1;
/*			transition: 100ms opacity;*/
			max-width: 20rem;
		}
		.hidden {
			opacity: 0 !important;
/*			transition: 100ms opacity;*/
		}

		h1 {
			text-align: center;
			width: 100%;
			display: block;
			margin: 0;
			padding: 0;
			margin-top: 1rem;
			margin-bottom: 1rem;
			font-style: italic;
			font-size: inherit;
			font-weight: inherit;
		}
		</style>
	</head>

	<body>
		<div id="container">
			<div id="main">
				<div id="contact" style="float:right">
					<i><a href = "mailto: quewon.chin@gmail.com">email</a>,  <a href="https://frogmen.itch.io">itch.io</a>, <a href="https://www.youtube.com/channel/UCE5He-8WmOMF-IsaOtWoA2g">youtube</a>, <a href="https://twitter.com/quewon_">twitter</a>, <a href="https://soundcloud.com/soregold">sc</a>, <a href="https://cohost.org/quewon/">ch</a>...</i>
				</div><br>
				<br>
				welcome to q1's bedroom :)<br>
				proudly sporting 11pt Times New Roman in this vast white void
				<h1>faq</h1>
				Q: is this really everything you've ever made in your life?<br>
				A: no!<br>
				<br>
				Q: oh, is that why all the good ones are missing?<br>
				A: what!?
				<h1>#</h1>
				<ul id="list"></ul>
			</div>
			<iframe src="" id="frame" frameBorder="0"></iframe>
			<div id="tag"></div>
		</div>

		<div id="tooltip" class="hidden"></div>
	</body>

	<script type="text/javascript" src="database.js"></script>
	<script>
		const tooltip = document.getElementById("tooltip");
		document.addEventListener("mousemove", function(e) {
			let x = e.pageX;
			let y = e.pageY;
			tooltip.style.left = x+"px";
			tooltip.style.top = y+"px";
		});

		function clear_tooltip() {
			tooltip.classList.add("hidden");
		}

		function display_tooltip(id) {
			let string = links[id].tooltip;

			if (!string) return;

			tooltip.textContent = string;
			tooltip.classList.remove("hidden");
		}

		const list = document.getElementById("list");
		const featured_iframe = document.getElementById("frame");
		const featured_tag = document.getElementById("tag");

		// sort links by date
		for (let link of links) {
			let date = link.date.split("/");

			let y = date[0];
			let m = date[1] < 10 ? "0"+date[1] : date[1];
			let d = date[2] < 10 ? "0"+date[2] : date[2];

			link.date_value = Number(y+m+d);
		}

		links = links.sort(function(a,b){ return b.date_value - a.date_value; });

		console.log(links);

		// place links
		var categories = {};
		for (let i=0; i<links.length; i++) {
			let link = links[i];
			let category = categories[link.category];
			if (!category) {
				let li = document.createElement("li");
				let a = document.createElement("a");
				a.textContent = link.category in category_names ? category_names[link.category] : link.category;
				a.onclick = function() { this.parentNode.classList.toggle("open") };
				li.appendChild(a);
				list.appendChild(li);

				let ul = document.createElement("ul");
				ul.className = "inf";
				li.appendChild(ul);
				li.classList.add("category");

				categories[link.category] = ul;
				category = ul;
			}

			let li = document.createElement("li");

			let html = "<span class='date'>"+link.date+"</span> <span><a onmouseover='display_tooltip("+i+")' onmouseout='clear_tooltip()' href='"+link.link+"'>"+link.name+"</a>";

			if ('with' in link) {
				html += " (with ";
				for (let i=0; i<link.with.length; i++) {
					html += "<a target='_blank' href='"+collaborators[link.with[i]]+"'>"+link.with[i]+"</a>";
					if (i < link.with.length - 1) {
						html += " and ";
					}
				}

				html += ")";
			}
			html += "</span>";
			li.innerHTML = html;

			category.appendChild(li);

			if ('featured' in link) {
				featured_iframe.src = link.link;
				featured_tag.innerHTML = "<span class='date'>"+link.date+"</span>"+link.name;
			}
		}
	</script>
</html>
